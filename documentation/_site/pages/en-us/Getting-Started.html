<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title> Common Application Framework - Getting Started</title>
  <meta name="description" content="CAF Auditing Site Documentation">

  <link rel='shortcut icon' href='/documentation/caf-templates/favicon.ico' type='image/x-icon'/>
  <link rel="stylesheet" href="/documentation/caf-templates/assets/main.css">
  <link rel="stylesheet" href="/documentation/caf-templates/assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="/documentation/caf-templates/assets/css/HPEElements.css">
  <link rel="canonical" href="/documentation/pages/en-us/Getting-Started.html">
</head>


  <body ng-app="caf" disable-animation>

    
<header class="top-header" ng-controller="TopNavCtrl as tnc" header-scroll>
    <div class="container">
        <a href="{{ tnc.logo_url }}" class="logo"></a>
        <ul class="menu">
                <li class="menu-item" ng-repeat="(key, value) in tnc.top_nav_data.navigation_items">
                    <a localize-all="value"></a>
                </li>
        </ul>
    </div>
    <div class="menu-toggle" menu-toggle>
      <span class="hpe-icon hpe-menu"></span>
    </div>
</header>


<script type="application/json" id="top-nav-localization">
    {"navigation_items":[{"title":{"en-us":"Overview"},"url":{"en-us":"pages/en-us/overview"},"icon":"","primary":false},{"title":{"en-us":"Team"},"url":{"en-us":"pages/en-us/team"},"icon":"","primary":false},{"title":{"en-us":"Blog"},"url":{"en-us":"pages/en-us/blog/"},"icon":"","primary":false}]}
</script>


    <div class="content-container">

      <div class="container">
        <div class="row">
          <div class="wrapper-content">
            <div class="col-md-9">
              <div class="docs-content">
                <h1 id="getting-started">Getting Started</h1>

<p>These are the high level steps involved in setting up the Audit Management Service; they are explained in detail in this guide:</p>

<ol>
  <li>Install and configure Vertica 7.2.x on a dedicated machine.</li>
  <li>Install and configure Apache Kafka on a dedicated machine.</li>
  <li>With the use of the Chateau deployment toolset launch the Apache Kafka-Vertica scheduler and the Audit Management Web Service in Mesos/Marathon.</li>
  <li>Define an application’s audit events in an Audit Event Definition File.</li>
  <li>Register the Audit Event Definition File and add tenant(s) with the Audit Management Web Service. This will create the necessary database tables in Vertica.</li>
  <li>Generate the client-side auditing library using the Audit Event Definition File and the code generation plugin.</li>
  <li>Use the client-side auditing library to send audit events to Kafka. The Audit Scheduler will automatically load the events from Kafka into Vertica.</li>
</ol>

<h2 id="deploying-vertica">Deploying Vertica</h2>

<p>Vertica is a SQL database designed for delivering speed, scalability and support for analytics. In CAF Auditing Vertica is ultimately used for storing the audit events.  The events are stored on a per-application per-tenant basis. Analysis tools can be used on the data to gather metrics with regard to the use of the audited applications.</p>

<h3 id="development-deployment">Development Deployment</h3>

<p>For Development deployments of Vertica it is recommended that you use <a href="https://github.hpe.com/caf/vagrant-vertica">vagrant-vertica</a> and follow its supporting documentation to start a guest VM running Vertica with Vagrant. As part of this deployment the provisioning scripts will create the service user, loader user, reader user and reader role.</p>

<p>Vagrant-vertica is not recommended for production deployments. The caveats to using it are that:</p>

<ul>
  <li>Vertica DB usernames and passwords, used during automated installation, are held as plain text within the VM’s provisioning scripts.</li>
  <li>It’s a standalone single node setup only; provisioning scripts do not support clustered configurations.</li>
</ul>

<h3 id="enterprise-deployment">Enterprise Deployment</h3>

<p>For Enterprise deployments of Vertica it is recommended that you follow the official HP Vertica documentation as it covers cluster setup, configuration and backup. Integration of Vertica with your Kafka broker cluster is also covered: <a href="https://my.vertica.com/documentation/vertica/7-2-x/">Official HP Vertica Documentation</a></p>

<h4 id="database-role--service-accounts">Database, Role &amp; Service Accounts</h4>

<p>Once Vertica has been installed you will need to create a database, service accounts and a reader role. The creation of these are needed for Audit Management to work correctly.</p>

<p>Example commands for creating the database, users and roles are as follows:</p>

<h5 id="create-database">Create Database</h5>

<p>Log onto the Vertica machine as the dbadmin user.</p>

<p>If you do not have an existing shared Vertica database to you can create a new database with the admintools command utility:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>/opt/vertica/bin/admintools -t create_db -d "CAFAudit" -p "CAFAudit" -s 127.0.0.1
</code></pre>
</div>

<h5 id="create-caf-audit-read-only-user-role">Create CAF Audit Read-Only User Role</h5>

<p>A read-only role is required for users of search and anayltics services that wish to query the audit data in Vertica.</p>

<ul>
  <li>To create a CAF Audit Reader Role:</li>
</ul>

<p><img src="images/CreateAuditReaderRoleSQL.PNG" alt="Create Audit Reader Role SQL" /></p>

<div class="highlighter-rouge"><pre class="highlight"><code>CREATE ROLE "caf-audit-read";
</code></pre>
</div>

<ul>
  <li>Note that the following command example shows how to create a new user in Vertica, however in your environment you would grant an existing user that wishes to query data in Vertica, for search and analytics purposes, the read-only role. To create a new user and assign them a password with IDENTIFIED BY:</li>
</ul>

<p><img src="images/CreateAuditReaderUserSQL.PNG" alt="Create Audit Reader User SQL" /></p>

<div class="highlighter-rouge"><pre class="highlight"><code>CREATE USER "caf-audit-reader" IDENTIFIED BY 'c@FaR3aD3R';
</code></pre>
</div>

<ul>
  <li>To grant the user CAF Audit Reader Role:</li>
</ul>

<p><img src="images/GrantAuditReaderUserReaderRoleSQL.PNG" alt="Grant Reader Role to Audit Reader User SQL" /></p>

<div class="highlighter-rouge"><pre class="highlight"><code>GRANT "caf-audit-read" TO "caf-audit-reader";
</code></pre>
</div>

<ul>
  <li>Enable the user with the CAF Audit Reader Role:</li>
</ul>

<p><img src="images/EnableAuditReaderUserReaderRoleSQL.PNG" alt="Enable the Audit Reader User's Reader Role SQL" /></p>

<div class="highlighter-rouge"><pre class="highlight"><code>ALTER USER "caf-audit-reader" DEFAULT ROLE "caf-audit-read";
</code></pre>
</div>

<h5 id="create-caf-audit-service-user">Create CAF Audit Service User</h5>

<p>A service account is required for the Audit Management Web Service to create database tables for registered applications and their tenants.</p>

<ul>
  <li>To create the CAF Audit Service User and assign them a password with IDENTIFIED BY:</li>
</ul>

<p><img src="images/CreateAuditServiceUserSQL.PNG" alt="Create the Audit Service User SQL" /></p>

<div class="highlighter-rouge"><pre class="highlight"><code>CREATE USER "caf-audit-service" IDENTIFIED BY 'c@Fa5eR51cE';
</code></pre>
</div>

<ul>
  <li>To grant the CAF Audit Service User database CREATE permission:</li>
</ul>

<p><img src="images/GrantAuditServiceUserCreatePermissionSQL.PNG" alt="Grant the Audit Service User CREATE permissions on CAFAudit SQL" /></p>

<div class="highlighter-rouge"><pre class="highlight"><code>GRANT CREATE ON DATABASE "CAFAudit" TO "caf-audit-service";
</code></pre>
</div>

<h5 id="create-caf-audit-loader-user">Create CAF Audit Loader User</h5>

<p>A loader account is required for the Kafka-Vertica Scheduler for loading audit events from Kafka into Vertica.</p>

<ul>
  <li>To create the CAF Audit Loader User and assign them a password with IDENTIFIED BY:</li>
</ul>

<p><img src="images/CreateAuditLoaderUserSQL.PNG" alt="Create the Audit Loader User SQL" /></p>

<div class="highlighter-rouge"><pre class="highlight"><code>CREATE USER "caf-audit-loader" IDENTIFIED BY 'c@FaL0Ad3r';
</code></pre>
</div>

<ul>
  <li>To grant the CAF Audit Loader User pseudo super user role:</li>
</ul>

<p><img src="images/GrantAuditLoaderUserSudoRoleSQL.PNG" alt="Grant PSEUDOSUPERUSER Role to Audit Loader User SQL" /></p>

<div class="highlighter-rouge"><pre class="highlight"><code>GRANT PSEUDOSUPERUSER TO "caf-audit-loader";
</code></pre>
</div>

<ul>
  <li>To enable the CAF Audit Loader User with the pseudo super user role:</li>
</ul>

<p><img src="images/EnableAuditServiceUserSudoRoleSQL.PNG" alt="Enable Audit Loader User with PSEUDOSUPERUSER Role SQL" /></p>

<div class="highlighter-rouge"><pre class="highlight"><code>ALTER USER "caf-audit-loader" DEFAULT ROLE PSEUDOSUPERUSER;
</code></pre>
</div>

<h4 id="prepare-vertica-with-kafka-vertica-scheduler-schema">Prepare Vertica with Kafka-Vertica Scheduler schema</h4>

<p>The vkconfig script, which comes pre-packaged and installed with the Vertica rpm, should be used with the <em>scheduler</em> sub-utility and <em>–add</em> option to add a schema for the Kafka-Vertica scheduler to keep track of application tenant topics. The command needs to be ran as the root or dbadmin user:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>/opt/vertica/packages/kafka/bin/vkconfig scheduler --add 
	--config-schema auditscheduler 
	--brokers [BROKERS] 
	--username [USERNAME] 
	--password [PASSWORD] 
	--operator [OPERATOR]
</code></pre>
</div>

<p>where:</p>

<ul>
  <li>[BROKERS] - This specifies the kafka broker(s) to be used, it is formatted as a comma separated list of address:port endpoints.</li>
  <li>[USERNAME] - This is the Vertica database loader account name (e.g. caf-audit-loader).</li>
  <li>[PASSWORD] - This is the password for the Vertica database loader account name. (e.g. “c@FaL0Ad3r”)</li>
  <li>[OPERATOR] - This is the Vertica database loader account name wrapped in double quotes(e.g. “"caf-audit-loader"”).</li>
</ul>

<p>Example:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>/opt/vertica/packages/kafka/bin/vkconfig scheduler --add --config-schema auditscheduler --brokers 192.168.56.20:9092 --username caf-audit-loader --password "c@FaL0Ad3r" --operator "\"caf-audit-loader\""
</code></pre>
</div>

<h5 id="verification">Verification</h5>

<p>The following figure shows the CAFAudit database with a new schema for tracking application tenant topics after running the <code class="highlighter-rouge">vkconfig scheduler --add</code> command:</p>

<p><img src="images/CAFAuditAuditSchedulerSchema.PNG" alt="CAFAudit DB with auditscheduler schema" /></p>

<h2 id="deploying-kafka">Deploying Kafka</h2>

<p>Apache Kafka is a distributed, partitioned, replicated commit log service that provides messaging system functionality for producers and consumers of messages. Kafka’s role in the Audit Management Service is that it receives tenant events from client-side applications (producers) as messages. On the server-side the Kafka-Vertica Scheduler (consumer) reads event messages from per application per tenant Kafka topics and streams the events into Vertica.</p>

<h3 id="development-deployment-1">Development Deployment</h3>

<p>For Development deployments of Vertica it is recommended that you use <a href="https://github.hpe.com/caf/vagrant-kafka">vagrant-kafka</a> and follow its supporting documentation to start a guest VM running Kafka with Vagrant.</p>

<p>Vagrant-kafka is not recommended for production deployments. The caveats to using it are that:</p>

<ul>
  <li>It’s a standalone single node setup only; provisioning scripts do not support multiple machine clustered configurations.</li>
</ul>

<h3 id="enterprise-deployment-1">Enterprise Deployment</h3>

<p>For Enterprise deployments of Kafka it is recommended that you follow the official Apache Kafka documentation as it covers clustered deployments and topic partitioning: <a href="http://kafka.apache.org/documentation.html">Apache Kafka Documentation</a></p>

<p>Integration of Vertica with your Kafka broker cluster is covered in the <a href="https://my.vertica.com/documentation/vertica/7-2-x/">Official HP Vertica Documentation</a></p>

<h2 id="deploying-caf-audit-web-service-and-kafka-vertica-scheduler">Deploying CAF Audit Web Service and Kafka-Vertica scheduler</h2>

<h3 id="audit-management-web-service">Audit Management Web Service</h3>

<p>The Audit Management Web Service offers a REST API for CAF Audit users to register and prepare Vertica and the Kafka-Vertica Scheduler with their applications and tenants using those applications.</p>

<h3 id="kafka-vertica-scheduler">Kafka-Vertica Scheduler</h3>

<p>The Kafka-Vertica scheduler is responsible for consuming audit event messages, from per application per tenant Kafka topics, and streaming them into the appropriate Vertica database tables.</p>

<h3 id="deployment-with-chateau">Deployment with Chateau</h3>

<p><strong><a href="https://github.hpe.com/caf/chateau">Chateau</a></strong> can launch CAF workers and services such as the Audit Management Web Service and the Kafka-Vertica Scheduler.</p>

<ul>
  <li>
    <p>To download and set up Chateau, follow the instructions in the <a href="https://github.hpe.com/caf/chateau/blob/develop/README.md">README.md</a>.</p>
  </li>
  <li>
    <p>For Enterprise deployments of Vertica add the details of your Vertica host and user accounts to Chateau’s environment/vertica.json file.</p>
  </li>
  <li>
    <p>For Enterprise deployments of Kafka add the details of your Kafka brokers to Chateau’s environment/kafka.json file.</p>
  </li>
  <li>
    <p>To deploy the Audit Management Web Service and the Kafka-Vertica Scheduler, follow the <a href="https://github.hpe.com/caf/chateau/blob/develop/deployment.md">Service Deployment</a> guide and use the following option with the deployment shell script: <code class="highlighter-rouge">./deploy-service.sh audit</code></p>
  </li>
</ul>

<p>The following figure shows a Marathon environment running the CAF Audit services started with Chateau:</p>

<p><img src="images/MarathonWithAuditManagementService.PNG" alt="Marathon running CAF Audit Management Service" /></p>

<h2 id="writing-an-application-audit-event-definition-file">Writing an Application Audit Event Definition File</h2>

<p>An application for auditing requires the construction of an Audit Event Definition XML file that defines the name of the application and its events. With the use of the caf-audit-maven-plugin, the application’s definition file is used to generate a client-side library that the audited application calls to log tenant events. The definition file is then also used to register the application and its events for auditing with the server-side Audit Management Web Service.</p>

<p>The following figure illustrates the Audit Event Definition XML File’s schema.</p>

<p><img src="images/audit-event-definition-file-desc.png" alt="AuditEventDefinitionFileSchema" /></p>

<p><code class="highlighter-rouge">AuditedApplication</code> is the root element.</p>

<p><code class="highlighter-rouge">ApplicationId</code> identifies the application that the Audit Events are associated with.</p>

<p>For each Audit Event defined, <code class="highlighter-rouge">TypeId</code> is a string identifier for the particular event (e.g. viewDocument) and <code class="highlighter-rouge">CategoryId</code> is a string identifier for the category of the event.</p>

<p>A list of parameter elements are then defined for each Audit Event. This includes the <code class="highlighter-rouge">Name</code> of the parameter, the <code class="highlighter-rouge">Type</code> (i.e. string, short, int, long, float, double, boolean or date) and the <code class="highlighter-rouge">Description</code>. The <code class="highlighter-rouge">ColumnName</code> element is optional which can be used to force the use of a particular database column when storing the audit data. The <code class="highlighter-rouge">Constraints</code> element is also optional and this can be used to specify minimum and/or maximum length constraints for audit event parameters of <code class="highlighter-rouge">Type</code> string.</p>

<h3 id="using-the-schema-file">Using the Schema File</h3>

<p>If you reference the XML Schema file from your Audit Event Definition File then you should be able to use the Validate functionality that is built into most IDEs and XML Editors. This will allow you to easily check for syntax errors in your Audit Event Definition File. To do this add the standard <code class="highlighter-rouge">xsi:schemaLocation</code> attribute to the root <code class="highlighter-rouge">AuditedApplication</code> element. i.e:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;AuditedApplication xmlns="http://www.hpe.com/CAF/Auditing/Schema/AuditedApplication.xsd"
                    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                    xsi:schemaLocation="http://www.hpe.com/CAF/Auditing/Schema/AuditedApplication.xsd http://rh7-artifactory.hpswlabs.hp.com:8081/artifactory/policyengine-release/com/hpe/caf/caf-audit-schema/1.1/caf-audit-schema-1.1.jar!/schema/AuditedApplication.xsd"&gt;
</code></pre>
</div>

<p>Many IDEs and XML Editors will also use the schema file to provide IntelliSense and type-ahead when the definition file is being authored.</p>

<h3 id="example-audit-event-definition-xml">Example Audit Event Definition XML</h3>

<p>The following is an example of an Audit Event Definition File that is used to throughout this getting started guide:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;AuditedApplication</span> <span class="na">xmlns=</span><span class="s">"http://www.hpe.com/CAF/Auditing/Schema/AuditedApplication.xsd"</span>
                    <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
                    <span class="na">xsi:schemaLocation=</span><span class="s">"http://www.hpe.com/CAF/Auditing/Schema/AuditedApplication.xsd http://rh7-artifactory.hpswlabs.hp.com:8081/artifactory/policyengine-release/com/hpe/caf/caf-audit-schema/1.1/caf-audit-schema-1.1.jar!/schema/AuditedApplication.xsd"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;ApplicationId&gt;</span>SampleApp<span class="nt">&lt;/ApplicationId&gt;</span>
  <span class="nt">&lt;AuditEvents&gt;</span>
    <span class="nt">&lt;AuditEvent&gt;</span>
      <span class="nt">&lt;TypeId&gt;</span>viewDocument<span class="nt">&lt;/TypeId&gt;</span>
      <span class="nt">&lt;CategoryId&gt;</span>documentEvents<span class="nt">&lt;/CategoryId&gt;</span>
      <span class="nt">&lt;Params&gt;</span>
        <span class="nt">&lt;Param&gt;</span>
          <span class="nt">&lt;Name&gt;</span>docId<span class="nt">&lt;/Name&gt;</span>
          <span class="nt">&lt;Type&gt;</span>long<span class="nt">&lt;/Type&gt;</span>
          <span class="nt">&lt;Description&gt;</span>Document Identifier<span class="nt">&lt;/Description&gt;</span>
        <span class="nt">&lt;/Param&gt;</span>
      <span class="nt">&lt;/Params&gt;</span>
    <span class="nt">&lt;/AuditEvent&gt;</span>
    <span class="nt">&lt;AuditEvent&gt;</span>
      <span class="nt">&lt;TypeId&gt;</span>deleteDocument<span class="nt">&lt;/TypeId&gt;</span>
      <span class="nt">&lt;CategoryId&gt;</span>documentEvents<span class="nt">&lt;/CategoryId&gt;</span>
      <span class="nt">&lt;Params&gt;</span>
        <span class="nt">&lt;Param&gt;</span>
          <span class="nt">&lt;Name&gt;</span>docId<span class="nt">&lt;/Name&gt;</span>
          <span class="nt">&lt;Type&gt;</span>long<span class="nt">&lt;/Type&gt;</span>
          <span class="nt">&lt;Description&gt;</span>Document Identifier<span class="nt">&lt;/Description&gt;</span>
        <span class="nt">&lt;/Param&gt;</span>
        <span class="nt">&lt;Param&gt;</span>
          <span class="nt">&lt;Name&gt;</span>authorisedBy<span class="nt">&lt;/Name&gt;</span>
          <span class="nt">&lt;Type&gt;</span>string<span class="nt">&lt;/Type&gt;</span>
		  <span class="nt">&lt;Constraints&gt;</span>
			<span class="nt">&lt;MinLength&gt;</span>1<span class="nt">&lt;/MinLength&gt;</span>
			<span class="nt">&lt;MaxLength&gt;</span>256<span class="nt">&lt;/MaxLength&gt;</span>
		  <span class="nt">&lt;/Constraints&gt;</span>
          <span class="nt">&lt;Description&gt;</span>User who authorised the deletion<span class="nt">&lt;/Description&gt;</span>
        <span class="nt">&lt;/Param&gt;</span>
      <span class="nt">&lt;/Params&gt;</span>
    <span class="nt">&lt;/AuditEvent&gt;</span>
  <span class="nt">&lt;/AuditEvents&gt;</span>
<span class="nt">&lt;/AuditedApplication&gt;</span>
</code></pre>
</div>

<h2 id="using-the-audit-management-web-service">Using the Audit Management Web Service</h2>

<p>To start using the web service, the endpoints can be exercised by accessing the Swagger Web UI at the following URL:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>http://&lt;audit.web.service.host.address&gt;:&lt;port&gt;/caf-audit-management-ui
</code></pre>
</div>

<p>Replace <code class="highlighter-rouge">&lt;audit.web.service.host.address&gt;</code> and <code class="highlighter-rouge">&lt;port&gt;</code> as necessary.</p>

<h3 id="loading-the-xml-audit-events-file">Loading the XML Audit Events File</h3>

<p>Application audit events that will occur are defined within the Audit Event Definition File which is used to register the application on the server-side. The following screenshot shows the /applications endpoint for loading this file:</p>

<p><img src="images/addApplication.png" alt="Overview" /></p>

<h4 id="verification-instructions">Verification Instructions</h4>

<p>When an application events file is registered this operation configures the Vertica database with audit management tables to record both the application specific audit events XML as well as tenants added through the service. See tables <code class="highlighter-rouge">ApplicationEvents</code> and <code class="highlighter-rouge">TenantApplications</code> under the <code class="highlighter-rouge">AuditManagement</code> schema in the Vertica database. An entry in the <code class="highlighter-rouge">ApplicationEvents</code> table will also be created to register the application events XML supplied. The following figure shows the <code class="highlighter-rouge">ApplicationEvents</code> table containing an entry for the SampleApp Audit Event Definition file:</p>

<p><img src="images/AuditManagementApplicationEventsWithSampleAppVertica.png" alt="Audit Management Application Events Table With Sample Application" /></p>

<p>Further calls to load new application Audit Event Definition files will result in additional rows being added to the <code class="highlighter-rouge">ApplicationEvents</code> table.</p>

<h3 id="adding-tenants">Adding Tenants</h3>

<p>Once applications have been registered, tenants can then be added using the /tenants endpoint. The tenant and application identifiers need to be supplied in the call to this endpoint. It is possible to associate a tenant with more than one application by passing multiple application identifiers as a JSON array of strings.</p>

<p><img src="images/addTenant.png" alt="Overview" /></p>

<h4 id="verification-instructions-1">Verification Instructions</h4>

<p>Every time a new tenant is added, a new row is inserted into the <code class="highlighter-rouge">TenantApplications</code> table under the <code class="highlighter-rouge">AuditManagement</code> schema. The following figure illustrates this:</p>

<p><img src="images/AuditManagementTenantApplicationsWithTenantApplication.png" alt="Audit Management Tenant Applications Table With Tenant ID" /></p>

<p>A new tenant specific database schema is then created for the tenant in the Vertica database which comprises of a number of tables. See <a href="https://github.hpe.com/caf/caf-audit-management-service-container/blob/develop/documentation/auditing-database-tables.md">Auditing Database Tables</a>. If the client-side auditing library has sent audit events for this tenant through to the Kafka messaging service, this audit event data should start to arrive in the application specific audit events table under the tenant specific schema created as part of the add tenant web service call.</p>

<p>The following figure shows an <code class="highlighter-rouge">account_1</code> schema with an <code class="highlighter-rouge">AuditSampleApp</code> table and the columns for audit event data for the application:</p>

<p><img src="images/account_1AuditSampleAppColumns.png" alt="CAF Audit Account 1 Sample App Table Columns" /></p>

<p>In the case that malformed audit events are passed to auditing there is a reject table for holding these. The following figure shows the <code class="highlighter-rouge">account_1</code> schema with a <code class="highlighter-rouge">kafka_rej</code> table and columns for rejected audit event data:</p>

<p><img src="images/account_1RejectTable.png" alt="CAF Audit Account 1 Kafka Reject Table Columns" /></p>

<h2 id="generating-a-client-side-auditing-library">Generating a client-side Auditing Library</h2>

<p>As discussed above, in order to use CAF Auditing you must first define the audit events in an Audit Event Definition File. After you have created the definition file you can use it to generate a client-side library to make it easier to raise the defined audit events.</p>

<p>Technically you do not need to generate a client-side library in order to use CAF Auditing; you could use the caf-audit module directly, but generating a client-side library should make it easier and safer to raise events, as it should mean that each event can be raised with a single type-safe call.
Here is a sample Maven project file that generates a client-side auditing library:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">"http://maven.apache.org/POM/4.0.0"</span>
     <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
     <span class="na">xsi:schemaLocation=</span><span class="s">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>

    <span class="nt">&lt;groupId&gt;</span>com.hpe.sampleapp<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>sampleapp-audit<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>

    <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
        <span class="nt">&lt;maven.compiler.source&gt;</span>1.8<span class="nt">&lt;/maven.compiler.source&gt;</span>
        <span class="nt">&lt;maven.compiler.target&gt;</span>1.8<span class="nt">&lt;/maven.compiler.target&gt;</span>
    <span class="nt">&lt;/properties&gt;</span>

    <span class="nt">&lt;dependencies&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>com.hpe.caf<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>caf-audit<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>1.2<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>

    <span class="nt">&lt;build&gt;</span>
        <span class="nt">&lt;plugins&gt;</span>
            <span class="nt">&lt;plugin&gt;</span>
                <span class="nt">&lt;groupId&gt;</span>com.hpe.caf<span class="nt">&lt;/groupId&gt;</span>
                <span class="nt">&lt;artifactId&gt;</span>caf-audit-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
                <span class="nt">&lt;version&gt;</span>1.1<span class="nt">&lt;/version&gt;</span>
                <span class="nt">&lt;executions&gt;</span>
                    <span class="nt">&lt;execution&gt;</span>
                        <span class="nt">&lt;id&gt;</span>generate-code<span class="nt">&lt;/id&gt;</span>
                        <span class="nt">&lt;phase&gt;</span>generate-sources<span class="nt">&lt;/phase&gt;</span>
                        <span class="nt">&lt;goals&gt;</span>
                            <span class="nt">&lt;goal&gt;</span>xmltojava<span class="nt">&lt;/goal&gt;</span>
                        <span class="nt">&lt;/goals&gt;</span>
                    <span class="nt">&lt;/execution&gt;</span>
                <span class="nt">&lt;/executions&gt;</span>
                <span class="nt">&lt;configuration&gt;</span>
                    <span class="nt">&lt;auditXMLConfig&gt;</span>src/main/xml/sampleapp-auditevents.xml<span class="nt">&lt;/auditXMLConfig&gt;</span>
                    <span class="nt">&lt;packageName&gt;</span>${project.groupId}.auditing<span class="nt">&lt;/packageName&gt;</span>
                <span class="nt">&lt;/configuration&gt;</span>
            <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;/plugins&gt;</span>
    <span class="nt">&lt;/build&gt;</span>

    <span class="nt">&lt;pluginRepositories&gt;</span>
        <span class="nt">&lt;pluginRepository&gt;</span>
            <span class="nt">&lt;id&gt;</span>cmbg-maven-releases<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;name&gt;</span>Cambridge Nexus Releases<span class="nt">&lt;/name&gt;</span>
            <span class="nt">&lt;url&gt;</span>http://cmbg-maven.autonomy.com/nexus/content/repositories/releases<span class="nt">&lt;/url&gt;</span>
            <span class="nt">&lt;snapshots&gt;</span>
                <span class="nt">&lt;enabled&gt;</span>false<span class="nt">&lt;/enabled&gt;</span>
            <span class="nt">&lt;/snapshots&gt;</span>
        <span class="nt">&lt;/pluginRepository&gt;</span>
    <span class="nt">&lt;/pluginRepositories&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre>
</div>

<h3 id="maven-coordinates">Maven Coordinates</h3>

<p>Like any other Maven project, the client-side auditing library must be assigned unique groupId, artifactId and version that can by used to reference it.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;groupId&gt;com.hpe.sampleapp&lt;/groupId&gt;
&lt;artifactId&gt;sampleapp-audit&lt;/artifactId&gt;
&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
</code></pre>
</div>

<h3 id="dependencies">Dependencies</h3>

<p>The generated library will have a dependency on caf-audit, which the generated code will use to raise the audit events. This dependency of course may introduce indirect transitive dependencies; these dependencies don’t need to be directly referenced as the generated code only uses types defined in the caf-audit library.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.hpe.caf&lt;/groupId&gt;
        &lt;artifactId&gt;caf-audit&lt;/artifactId&gt;
        &lt;version&gt;1.2&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>
</div>

<h3 id="code-generation-plugin">Code Generation Plugin</h3>

<p>The <code class="highlighter-rouge">xmltojava</code> goal of the code generation plugin is used to generate the Java auditing code that will make up the library. The <code class="highlighter-rouge">auditXMLConfig</code> setting can be used to define the path to the Audit Event Definition file, and the <code class="highlighter-rouge">packageName</code> setting can be used to set the package in which the auditing code should be generated.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;com.hpe.caf&lt;/groupId&gt;
            &lt;artifactId&gt;caf-audit-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;1.1&lt;/version&gt;
            &lt;executions&gt;
                &lt;execution&gt;
                    &lt;id&gt;generate-code&lt;/id&gt;
                    &lt;phase&gt;generate-sources&lt;/phase&gt;
                    &lt;goals&gt;
                        &lt;goal&gt;xmltojava&lt;/goal&gt;
                    &lt;/goals&gt;
                &lt;/execution&gt;
            &lt;/executions&gt;
            &lt;configuration&gt;
                &lt;auditXMLConfig&gt;src/main/xml/sampleapp-auditevents.xml&lt;/auditXMLConfig&gt;
                &lt;packageName&gt;${project.groupId}.auditing&lt;/packageName&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;
</code></pre>
</div>

<p>In this example the Audit Event Definition file is in the <code class="highlighter-rouge">src/main/xml/</code> folder, though of course it could be read from any folder. The name of the package to use is being built up by appending “.auditing” the project’s group identifier (i.e. “com.hpe.sampleapp” in this example).</p>

<h3 id="plugin-repositories">Plugin Repositories</h3>

<p>Depending on how your Maven settings.xml file is configured, the pluginRepositories section may or may not be required in order to locate the code generation plugin.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;pluginRepositories&gt;
    &lt;pluginRepository&gt;
        &lt;id&gt;cmbg-maven-releases&lt;/id&gt;
        &lt;name&gt;Cambridge Nexus Releases&lt;/name&gt;
        &lt;url&gt;http://cmbg-maven.autonomy.com/nexus/content/repositories/releases&lt;/url&gt;
        &lt;snapshots&gt;
            &lt;enabled&gt;false&lt;/enabled&gt;
        &lt;/snapshots&gt;
    &lt;/pluginRepository&gt;
&lt;/pluginRepositories&gt;
</code></pre>
</div>

<p>In this example the URL is set to <a href="http://cmbg-maven.autonomy.com/nexus/content/repositories/releases">http://cmbg-maven.autonomy.com/nexus/content/repositories/releases</a>, but if that location is inaccessible then you could try one of the following URLs instead:</p>

<ul>
  <li><a href="http://rh7-artifactory.hpswlabs.hp.com:8081/artifactory/policyengine-release">http://rh7-artifactory.hpswlabs.hp.com:8081/artifactory/policyengine-release</a></li>
  <li><a href="http://16.26.25.50/nexus/content/repositories/releases">http://16.26.25.50/nexus/content/repositories/releases</a></li>
  <li><a href="http://16.103.3.109:8081/artifactory/policyengine-release">http://16.103.3.109:8081/artifactory/policyengine-release</a></li>
</ul>

<h3 id="no-op-auditing-library">No-op Auditing Library</h3>

<p>A dummy implementation of the standard auditing library, <code class="highlighter-rouge">caf-audit</code>, is provided to support developers without any Apache Kafka infrastructure. It has the same interface as the standard auditing library but does not send anything to Kafka. This will allow developers to continue to work with their application without the need to install and configure Apache Kafka.</p>

<p>In order to make use of this no-op auditing library, simply modify the Maven Coordinates for the <code class="highlighter-rouge">caf-audit</code> dependency and specify <code class="highlighter-rouge">1.2-NOOP</code> as the version rather than just <code class="highlighter-rouge">1.2</code>:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.hpe.caf&lt;/groupId&gt;
        &lt;artifactId&gt;caf-audit&lt;/artifactId&gt;
        &lt;version&gt;1.2-NOOP&lt;/version&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;
</code></pre>
</div>

<p>Alternatively, you could do something more custom at runtime where you replace the standard auditing library jar with the no-op version if you prefer.</p>

<h2 id="using-the-client-side-auditing-library">Using the Client-side Auditing Library</h2>

<h3 id="dependencies-1">Dependencies</h3>

<p>A generated client-side library should be referenced in the normal way in the application’s POM file. You shouldn’t need to manually add a dependency on <code class="highlighter-rouge">caf-audit</code> as it will be a transitive dependency of the generated library.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.hpe.sampleapp&lt;/groupId&gt;
    &lt;artifactId&gt;sampleapp-audit&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
</div>

<h3 id="audit-connection">Audit Connection</h3>

<p>Regardless of whether you choose to use a generated client-side library, or to use <code class="highlighter-rouge">caf-audit</code> directly, you must first create an <code class="highlighter-rouge">AuditConnection</code> object.</p>

<p>This object represents a logical connection to the persistent storage (i.e. to Kafka in the current implementation). It is a thread-safe object. <strong><em>It should be considered that this object takes some time to construct, so the application should hold on to it and re-use it rather than constantly re-constructing it.</em></strong></p>

<p>The <code class="highlighter-rouge">AuditConnection</code> object can be constructed using the static <code class="highlighter-rouge">createConnection()</code> method in the <code class="highlighter-rouge">AuditConnectionFactory</code> class. This method takes a <code class="highlighter-rouge">ConfigurationSource</code> parameter, which is the standard method of configuration in CAF.</p>

<h4 id="configuration-in-caf">Configuration in CAF</h4>

<p>You may already have a CAF Configuration Source in your application. It is a general framework that abstracts away the source of the configuration, allowing it to come from environment variables, files, a REST service, or potentially a custom source which better integrates with the host application.</p>

<p>If you’re not already using CAF’s Configuration mechanism, then here is some sample code to generate a <code class="highlighter-rouge">ConfigurationSource</code> object.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>import com.hpe.caf.api.*;
import com.hpe.caf.cipher.NullCipherProvider;
import com.hpe.caf.config.system.SystemBootstrapConfiguration;
import com.hpe.caf.naming.ServicePath;
import com.hpe.caf.util.ModuleLoader;

public static ConfigurationSource createCafConfigSource() throws Exception
{
    System.setProperty("CAF_CONFIG_PATH", "/etc/sampleapp/config");
    System.setProperty("CAF_APPNAME", "sampleappgroup/sampleapp");

    BootstrapConfiguration bootstrap = new SystemBootstrapConfiguration();
    Cipher cipher = ModuleLoader.getService(CipherProvider.class, NullCipherProvider.class).getCipher(bootstrap);
    ServicePath path = bootstrap.getServicePath();
    Codec codec = ModuleLoader.getService(Codec.class);
    return ModuleLoader.getService(ConfigurationSourceProvider.class).getConfigurationSource(bootstrap, cipher, path, codec);
}
</code></pre>
</div>

<p>To compile the above sample code you will need to add the following dependencies to your POM:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;com.hpe.caf&lt;/groupId&gt;
    &lt;artifactId&gt;caf-api&lt;/artifactId&gt;
    &lt;version&gt;11.2&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.hpe.caf.cipher&lt;/groupId&gt;
    &lt;artifactId&gt;cipher-null&lt;/artifactId&gt;
    &lt;version&gt;10.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.hpe.caf.config&lt;/groupId&gt;
    &lt;artifactId&gt;config-system&lt;/artifactId&gt;
    &lt;version&gt;10.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.hpe.caf.util&lt;/groupId&gt;
    &lt;artifactId&gt;util-moduleloader&lt;/artifactId&gt;
    &lt;version&gt;1.1&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.hpe.caf.util&lt;/groupId&gt;
    &lt;artifactId&gt;util-naming&lt;/artifactId&gt;
    &lt;version&gt;1.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
</div>

<p>To use JSON-encoded files for your configuration you will need to add the following additional dependencies to your POM:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;!-- Runtime-only Dependencies --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.hpe.caf.config&lt;/groupId&gt;
    &lt;artifactId&gt;config-file&lt;/artifactId&gt;
    &lt;version&gt;10.0&lt;/version&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.hpe.caf.codec&lt;/groupId&gt;
    &lt;artifactId&gt;codec-json&lt;/artifactId&gt;
    &lt;version&gt;10.1&lt;/version&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;io.dropwizard&lt;/groupId&gt;
    &lt;artifactId&gt;dropwizard-core&lt;/artifactId&gt;
    &lt;version&gt;0.8.4&lt;/version&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre>
</div>

<h4 id="configuration-required-to-create-the-auditconnection">Configuration Required to create the AuditConnection</h4>

<p>In the above sample CAF Configuration is using JSON-encoded files with the following parameters:</p>

<ul>
  <li><code class="highlighter-rouge">CAF_CONFIG_PATH: /etc/sampleapp/config</code></li>
  <li><code class="highlighter-rouge">CAF_APPNAME: sampleappgroup/sampleapp</code></li>
</ul>

<p>Given this configuration, to configure CAF Auditing you should create a file named <code class="highlighter-rouge">cfg_sampleappgroup_sampleapp_KafkaAuditConfiguration</code> in the <code class="highlighter-rouge">/etc/sampleapp/config/</code> directory. The contents of this file should be similar to the following:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nt">"bootstrapServers"</span><span class="p">:</span><span class="w"> </span><span class="s2">"192.168.56.20:9092"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"acks"</span><span class="p">:</span><span class="w"> </span><span class="s2">"all"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"retries"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p><code class="highlighter-rouge">bootstrapServers</code> refers to one or more of the nodes of the Kafka cluster as a comma-separated list.
<code class="highlighter-rouge">acks</code> is the number of nodes in the cluster which must acknowledge an audit event when it is sent.</p>

<h3 id="audit-channel">Audit Channel</h3>

<p>After you have successfully constructed an <code class="highlighter-rouge">AuditConnection</code> object you must construct an <code class="highlighter-rouge">AuditChannel</code> object.</p>

<p>This object represents a logical channel to the persistent storage (i.e. to Kafka in the current implementation). It is NOT a thread-safe object so it must not be shared across threads without synchronisation. However there is no issue constructing multiple <code class="highlighter-rouge">AuditChannel</code> objects simultaneously on different threads, and the objects are lightweight so caching them is not that important.</p>

<p>The <code class="highlighter-rouge">AuditChannel</code> object can be constructed using the <code class="highlighter-rouge">createChannel()</code> method on the <code class="highlighter-rouge">AuditConnectionn</code> object. It does not take any parameters.</p>

<h3 id="audit-log">Audit Log</h3>

<p>The generated library contains an <code class="highlighter-rouge">AuditLog</code> class which contains static methods which can be used to log audit events.</p>

<p>Here is an example for a the SampleApp’s <code class="highlighter-rouge">viewDocument</code> event which takes a single document identifier parameter:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>/**
 * Audit the viewDocument event
 * @param channel Identifies the channel to be used for message queuing 
 * @param tenantId Identifies the tenant that the user belongs to 
 * @param userId Identifies the user who triggered the event 
 * @param correlationId Identifies the same user action 
 * @param docId Document Identifier 
 */
public static void auditViewDocument
(
    final AuditChannel channel,
    final String tenantId,
    final String userId,
    final String correlationId,
    final long docId
)
    throws Exception
{
    final AuditEventBuilder auditEventBuilder = channel.createEventBuilder();
    auditEventBuilder.setApplication(APPLICATION_IDENTIFIER);
    auditEventBuilder.setTenant(tenantId);
    auditEventBuilder.setUser(userId);
    auditEventBuilder.setCorrelationId(correlationId);
    auditEventBuilder.setEventType("documentEvents", "viewDocument");
    auditEventBuilder.addEventParameter("docId", null, docId);

    auditEventBuilder.send();
}
</code></pre>
</div>

<p>The name of the event is included in the generated method name. In addition to the custom parameters (document id in this case), the caller must pass the <code class="highlighter-rouge">AuditChannel</code> object to be used, as well as the tenant id, user id, and correlation id.</p>

<p>The method will throw an Exception if the audit event could not be stored for some reason (e.g. network failure).</p>

<h3 id="verification-instructions-2">Verification Instructions</h3>

<p>Every time an <code class="highlighter-rouge">AuditLog</code> method is called a new row will be entered into the tenant’s audit application table. The following figure shows the a tenant’s <code class="highlighter-rouge">account_1</code> schema’s <code class="highlighter-rouge">AuditSampleApp</code> table with an audit event entry with data for an audit event:</p>

<p><img src="images/account_1AuditSampleAppData.png" alt="Tenant 1 with AuditSampleApp audit event entry" /></p>

<hr />

<h2 id="links">Links</h2>

<p>For more information on Chateau, go <a href="https://github.hpe.com/caf/chateau">here</a>.</p>

<p>For more information on Vertica, go <a href="https://my.vertica.com/">here</a>.</p>

<p>For more information on Apache Kafka, go <a href="http://kafka.apache.org/">here</a>.</p>



                <div class="footer">
                  
                  <a class="pull-right" href=""><span class="hpe-icon hpe-contact-us align-text-bottom"></span> <span localize-text="'Submit Feedback'"></span></a>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              
<div ng-controller="SideNavCtrl as snc">
    <nav role="navigation" class="sidebar" ng-class="{ 'expanded': snc.side_nav_expanded }">

        <div class="header">
            <p class="title">CAF Documentation</p>
            <div class="close-button" ng-click="snc.side_nav_expanded = false">
                <i class="hpe-icon hpe-close"></i>
            </div>
        </div>

        <ul class="nav sidenav" side-menu>
            <li ng-repeat="(key, firstlevel) in snc.side_nav_data.navigation_items">
                <a localize-all="firstlevel" class="root-section" default-url="firstlevel.url" ng-class="{ 'hover-effect': firstlevel.url }"></a>
                <ul class="nav">
                    <li ng-repeat="(key, secondlevel) in firstlevel.children">
                        <a class="nav-item" localize-all="secondlevel" ng-if="secondlevel.url"></a>     
                        <a ng-if="secondlevel.children" default-url="secondlevel.children[0].url">
                            <span localize-all="secondlevel"></span>
                        </a>
                        <ul class="nav" ng-if="secondlevel.children">
                            <li ng-repeat="(key, thirdlevel) in secondlevel.children">
                                <a localize-all="thirdlevel" ng-if="thirdlevel.url"></a>
                                <a ng-if="thirdlevel.children">
                                    <span localize-all="thirdlevel"></span>
                                </a>
                                <ul class="nav" ng-if="thirdlevel.children">
                                    <li ng-repeat="(key, fourthlevel) in thirdlevel.children">
                                        <a localize-all="fourthlevel" ng-if="fourthlevel.url"></a>
                                    </li>
                                </ul>
                            </li>
                        </ul>               
                    </li>
                </ul>
            </li>
        </ul>

    </nav>

    <div class="side-nav-expand-btn visible-sm-block visible-xs-block" ng-click="snc.side_nav_expanded = true">
        <i class="hpe-icon hpe-app"></i>
    </div>
</div>



<script type="application/json" id="side-nav-localization">
    {"navigation_items":[{"title":{"en-us":"CAF Auditing"},"url":{"en-us":"pages/en-us/overview"},"children":[{"title":{"en-us":"Features"},"url":{"en-us":"pages/en-us/Features"}},{"title":{"en-us":"Getting Started"},"url":{"en-us":"pages/en-us/Getting-Started"}},{"title":{"en-us":"Architecture"},"url":{"en-us":"pages/en-us/Architecture"}},{"title":{"en-us":"Server-side API"},"url":{"en-us":"pages/en-us/Server-API"}},{"title":{"en-us":"Client-side API"},"url":{"en-us":"pages/en-us/Client-API"}},{"title":{"en-us":"Blog"},"url":{"en-us":"pages/en-us/blog/index"}}]}]}
</script>

            </div>
          </div>
        </div>
      </div>

    </div>

    
<footer class="link-footer container" ng-controller="FooterCtrl as ftc">
    <div class="footer-container">
      <ul class="footer-list">
        <li class="footer-item" ng-repeat="(key, value) in ftc.footer_data.navigation_items">
        	<a class="footer-link" localize-all="value"></a>
    	</li>
        <li class="footer-item">
          <localize-button></localize-button>
        </li>
      </ul>
    </div>
</footer>


<!-- Language modal here -->
<div ng-controller="LocalizeModalCtrl as lmc" class="modal fade" id="language-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog modal-lg square-modal-window" role="document">
    <div class="modal-content">
      <div class="modal-body language-modal">
        <h1 class="language-title"><span localize-text="'Choose A Region'"></span> <span class="hpe-icon hpe-close" data-dismiss="modal"></span></h1>

        <div class="continent" ng-repeat="(continent, continent_data) in lmc.continents">
          <p class="continent-title" ng-bind="continent"></p>
          <div class="region-list">
            <div class="region" ng-repeat="region in continent_data.countries" ng-click="lmc.select_region(region.abbreviation)">
              <p class="region-name" ng-class="{ 'active': region.abbreviation === lmc.selected_language }">
                <span ng-bind="region.country"></span>
              </p>
              <p class="region-language"><span ng-bind="region.language"></span> <span class="region-abbreviation">(<span ng-bind="region.abbreviation"></span>)</span></p>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>


<script type="application/json" id="footer-localization">
	{"navigation_items":[],"feedback_url":""}
</script>

<script type="application/json" id="current-page-urls">
  null
</script>


    <!-- Get the required JSON files and give them and ID so we may use them in our directive -->
    <script type="application/json" id="supported-languages">
      {"en-us":{"country":"United States","language":"English","continent":"North America"}}
    </script>

    <script type="application/json" id="documentation-localization">
      {"Accept":{"en-us":"Accept"},"Access Token":{"en-us":"Access Token"},"API Key":{"en-us":"API Key"},"API Key Authentication":{"en-us":"API Key Authentication"},"Authenticate":{"en-us":"Authenticate"},"Authorization URL":{"en-us":"Authorization URL"},"Cancel":{"en-us":"Cancel"},"Close":{"en-us":"Close"},"Code":{"en-us":"Code"},"Choose A Region":{"en-us":"Choose A Region"},"Contact information":{"en-us":"Contact information"},"Content-Type":{"en-us":"Content-Type"},"Contribute":{"en-us":"Contribute"},"Description":{"en-us":"Description"},"Details":{"en-us":"Details"},"Examples":{"en-us":"Examples"},"false":{"en-us":"false"},"Filter by tags":{"en-us":"Filter by tags"},"Flow":{"en-us":"Flow"},"Header Preview":{"en-us":"Header Preview"},"Headers":{"en-us":"Headers"},"HTTP Basic Authentication":{"en-us":"HTTP Basic Authentication"},"In":{"en-us":"In"},"License":{"en-us":"License"},"Location":{"en-us":"Location"},"Models":{"en-us":"Models"},"Name":{"en-us":"Name"},"OAuth 2.0 Authentication":{"en-us":"OAuth 2.0 Authentication"},"Parameters":{"en-us":"Parameters"},"Password":{"en-us":"Password"},"Paths":{"en-us":"Paths"},"Please follow OAuth flow, copy access token from OAuth and paste it here.":{"en-us":"Please follow OAuth flow, copy access token from OAuth and paste it here."},"Request":{"en-us":"Request"},"Required":{"en-us":"Required"},"Responses":{"en-us":"Responses"},"Schema":{"en-us":"Schema"},"Scheme":{"en-us":"Scheme"},"Scopes":{"en-us":"Scopes"},"Security":{"en-us":"Security"},"Security Schema":{"en-us":"Security Schema"},"Send Request":{"en-us":"Send Request"},"Submit Feedback":{"en-us":"Submit Feedback"},"Summary":{"en-us":"Summary"},"Terms of service":{"en-us":"Terms of service"},"Terms of Service":{"en-us":"Terms of Service"},"Token URL":{"en-us":"Token URL"},"true":{"en-us":"true"},"Try this operation":{"en-us":"Try this operation"},"User Name":{"en-us":"User Name"},"Version":{"en-us":"Version"},"Warning: Deprecated":{"en-us":"Warning: Deprecated"}}
    </script>

    <script src="/documentation/caf-templates/assets/js/third-party/jquery.min.js"></script>
    <script src="/documentation/caf-templates/assets/js/third-party/bootstrap.min.js"></script>
    <script src="/documentation/caf-templates/assets/js/polyfills.js"></script>
    <!-- Formatter Plugins -->
    <script src="/documentation/caf-templates/assets/js/third-party/jsonformatter.js"></script>
    <script src="/documentation/caf-templates/assets/js/third-party/schemaview.min.js"></script>
    <script src="/documentation/caf-templates/assets/js/third-party/ref-parser.js"></script>

    <script src="/documentation/caf-templates/assets/js/third-party/angular.js"></script>
    <script src="/documentation/caf-templates/assets/js/third-party/angular-recursion.js"></script>
    <script src="/documentation/caf-templates/assets/js/third-party/moment.min.js"></script>
    <script src="/documentation/caf-templates/assets/js/third-party/jquery.dotdotdot.min.js"></script>
    <script src="/documentation/caf-templates/assets/js/third-party/lodash.min.js"></script>
    <script src="/documentation/caf-templates/assets/js/elements/hpe-elements-angular.min.js"></script>
    <script src="/documentation/caf-templates/assets/js/third-party/md2html.js"></script>
    <script src="/documentation/caf-templates/assets/js/third-party/yaml2js.js"></script>
    <script src="/documentation/caf-templates/assets/js/third-party/json-editor.js"></script>
    <script src="/documentation/caf-templates/assets/js/third-party/schema-form.min.js"></script>
    <script src="/documentation/caf-templates/assets/js/third-party/marked.js"></script>
    <script src="/documentation/caf-templates/assets/js/third-party/angular-marked.min.js"></script>

    <script src="/documentation/caf-templates/assets/js/app.js"></script>
    <script src="/documentation/caf-templates/assets/js/localization.js"></script>
    <script src="/documentation/caf-templates/assets/js/swagger.js"></script>
    <script src="/documentation/caf-templates/assets/js/swagger_try.js"></script>

    <script type="text/javascript">
      var baseUrl = '/documentation';
    </script>

  </body>

</html>
